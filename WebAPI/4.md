<h2>Трехстороннее рукопожатие (Triple handshake) </h2>  
  
это процесс установки защищенного соединения между клиентом и сервером при использовании протокола TLS/SSL. В отличие от обычного двустороннего рукопожатия, трехстороннее рукопожатие включает дополнительный шаг для подтверждения истории шифрования.
  
Во время трехстороннего рукопожатия происходят следующие шаги:  

1. Клиент отправляет первое "Client Hello" сообщение серверу, в котором предлагает список поддерживаемых шифров и другие параметры. Он также генерирует случайное число, известное как "client random".

2. Сервер отвечает "Server Hello" сообщением, в котором выбирает шифр и параметры из предложенного клиентом списка. Он также генерирует свое собственное случайное число, известное как "server random".

3. Вместе с "Server Hello" сообщением сервер отправляет публичный ключ сертификата, содержащего информацию о сервере и его публичный ключ. Этот сертификат может быть проверен клиентом с помощью корневых сертификатов.

4. **Клиент проверяет сертификат сервера и, если он доверяет ему, генерирует предварительный мастер-ключ. Затем он зашифровывает его с использованием публичного ключа сервера и отправляет серверу (это называется "Client Key Exchange")**.

5. Сервер расшифровывает полученный клиентом зашифрованный предварительный мастер-ключ с помощью своего приватного ключа. Затем оба - клиент и сервер - генерируют из предварительного мастер-ключа общий мастер-ключ.

6. Затем происходит обмен сообщениями "Change Cipher Spec", которые сообщают друг другу, что все последующие сообщения будут зашифрованы.

7. Клиент и сервер используют общий мастер-ключ для создания симметричного ключа шифрования и дешифрования данных, которые будут передаваться между ними.


**Трехстороннее рукопожатие используется для обеспечения безопасности и аутентификации при установке защищенного соединения.**  
  
Оно помогает обеспечить конфиденциальность данных и защиту от атак вроде осуществления Man-in-the-Middle.
